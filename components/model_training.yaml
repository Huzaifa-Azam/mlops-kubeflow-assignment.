name: Model training
description: Trains a Random Forest classifier (regressor for housing data) and saves
  the model.
inputs:
- {name: train_csv, type: String}
outputs:
- {name: model_pkl, type: String}
implementation:
  container:
    image: python:3.8
    command:
    - sh
    - -c
    - (PIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location
      'pandas' 'scikit-learn' 'joblib' || PIP_DISABLE_PIP_VERSION_CHECK=1 python3
      -m pip install --quiet --no-warn-script-location 'pandas' 'scikit-learn' 'joblib'
      --user) && "$0" "$@"
    - sh
    - -ec
    - |
      program_path=$(mktemp)
      printf "%s" "$0" > "$program_path"
      python3 -u "$program_path" "$@"
    - "def _make_parent_dirs_and_return_path(file_path: str):\n    import os\n   \
      \ os.makedirs(os.path.dirname(file_path), exist_ok=True)\n    return file_path\n\
      \ndef model_training(train_csv, \n                   model_pkl):\n    \"\"\"\
      \n    Trains a Random Forest classifier (regressor for housing data) and saves\
      \ the model.\n    \"\"\"\n    import pandas as pd\n    import joblib\n    from\
      \ sklearn.ensemble import RandomForestRegressor\n\n    print(\"Loading training\
      \ data...\")\n    df = pd.read_csv(train_csv)\n    X = df.drop('target', axis=1)\n\
      \    y = df['target']\n\n    print(\"Training model...\")\n    model = RandomForestRegressor(n_estimators=100,\
      \ random_state=42)\n    model.fit(X, y)\n\n    print(\"Saving model...\")\n\
      \    joblib.dump(model, model_pkl)\n    print(f\"Model saved to {model_pkl}\"\
      )\n\nimport argparse\n_parser = argparse.ArgumentParser(prog='Model training',\
      \ description='Trains a Random Forest classifier (regressor for housing data)\
      \ and saves the model.')\n_parser.add_argument(\"--train-csv\", dest=\"train_csv\"\
      , type=str, required=True, default=argparse.SUPPRESS)\n_parser.add_argument(\"\
      --model-pkl\", dest=\"model_pkl\", type=_make_parent_dirs_and_return_path, required=True,\
      \ default=argparse.SUPPRESS)\n_parsed_args = vars(_parser.parse_args())\n\n\
      _outputs = model_training(**_parsed_args)\n"
    args:
    - --train-csv
    - {inputPath: train_csv}
    - --model-pkl
    - {outputPath: model_pkl}
